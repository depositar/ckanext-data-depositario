========
操作手冊
========

「|site_name| （depositar）」（下稱「本平台」）為提供研究資料寄放、保存、管理與瀏覽之公眾系統。此系統以開放源碼軟體套件 `CKAN <http://ckan.org>`_ 開發，並增添多項新功能。本平台網址位於 https://data.depositar.io。

本操作手冊說明如何使用本平台的介面上傳、管理、發布及搜尋資料。CKAN 同時提供功能豐富的 API 介面，讓開發者更易於自行擴充功能或是連結至其他資訊系統。相關 API 資訊可參考 `CKAN 的 API 文件 <http://docs.ckan.org/en/2.7/api/index.html>`_。

本平台的使用者介面之中有部份功能僅限於系統管理員操作，相關說明請參考 `CKAN 的系統管理者文件 <http://docs.ckan.org/en/2.7/sysadmin-guide.html>`_。

.. note::

   本手冊翻譯與修改自 Open Knowledge International 以及貢獻者所編寫之 `User guide — CKAN 2.7.6 documentation`_，該作品以 `創用CC 姓名標示-相同方式分享 3.0 未本地化 <https://creativecommons.org/licenses/by-sa/3.0/deed.zh_TW>`_ (`Creative Commons Attribution-ShareAlike 3.0 Unported <https://creativecommons.org/licenses/by-sa/3.0/>`_) 授權條款釋出。

---------
CKAN 簡介
---------

CKAN 為用來建立開放資料平台的開源軟體套件（類似於內容管理系統 WordPress，但非用於管理頁面與部落格等資訊，而是用來管理「資料」），在 CKAN 平台上可管理與發布資料集。目前 CKAN 已廣為各國家政府、地方政府及研究機構等收集有大量資料集的單位所採用。本平台即是使用 CKAN 並擴增功能建置。

當資料發布於本平台後，任何使用者可透過其提供的資料搜尋功能，搜尋或瀏覽他們所需的資料，並且可以在網頁上直接瀏覽資料的樣貌（包括地圖、縮圖、表格等類型）。

資料集與資源
============

本平台遵循 CKAN 的運作機制，將資料的發布單元稱之為「資料集」（dataset）。「資料集」顧名思義為資料的集合，舉例而言，資料集可以是一個區域的犯罪統計資料、政府部門的經費收支圖表，或者是由各類型天氣測站所觀測到的溫度數據。當使用者在 CKAN 平台上搜尋資料時，所呈現的搜尋結果即為資料集。

一份資料集包含：

* **後設資料** (metadata)：即為資料集的描述。例如：資料集的標題、產製者、產製時間、資料格式、該資料集以何種方式授權使用等相關說明資訊。

* **資源** (resources)：即實際的資料本身。CKAN 平台可以存放任何檔案類型或格式的資料。一份「資源」可以是 CSV 表單、Excel 試算表、XML 檔案、PDF 文件、影像檔、RDF 格式的連結資料等。CKAN 可以將各類型的資源儲存在系統內部，或者儲存資源的連結，且一份資料集可以儲存任意數量的資源。例如，不同的資源可能儲存不同年份的資料，或是相同的資料以不同格式的資源儲存。

----------
使用本平台
----------

註冊帳號與登入
==============

.. note::

   當您想發布資料於本平台或執行一些本平台所提供的個人化功能時，您必須具有本平台使用者帳號。但搜尋與下載公開資料集僅需訪客身分即可。

.. hint::

   本平台另提供一展示用網站供您評估功能。您可於展示用網站自由註冊帳號與測試任何本平台提供之功能。請留意該展示用網站之資料會定期清除。該展示網站的網址：https://demo.depositar.io。

請點選頁面上方的「註冊」來建立一組本平台的帳號，並提供下列資訊：

* *使用者帳號* -- 輸入一組使用者帳號，僅限使用文數字、「-」與「_」符號。

* *全名* -- 顯示於您個人頁面上的名稱。

* *電子郵件* -- 電子郵件為私有資訊，不會公開於本平台上。

.. image:: /images/register_account.png

若您輸入的內容有任何錯誤，本平台將顯示紅色警告訊息提示您進行修正。當輸入的內容皆正確後，點選「建立帳號」功能鈕，本平台將寄發密碼設定信件（內容如下）至您填寫的電子郵件信箱，請依據信件指示完成密碼設定，即可建立帳號。點選頁面上方的「登入」按鈕以登入您的帳號。

.. parsed-literal::

   OOO 您好，

   您已發送密碼重設要求至 depositar。

   請點選以下連結以確認此要求：

     :site_url:`user/reset/[token]`

   祝您有個美好的一天。

   --
   depositar (https://data.depositar.io)

資料發布功能
============

.. _adding_a_new_dataset:

新增資料集
----------

.. note::

   您必須擁有使用者帳號方能新增資料集。

**步驟 1**. 透過下列兩種方式可以連結至「新增資料集」頁面：

a) 點選於頁面上方的「資料集」連結，於接下來顯示的資料搜尋頁面上方即可看見「新增資料集」連結。

b) 點選頁面上方的「專案」連結，接下來請選擇您所要發布資料集所隸屬的專案，若您的使用者帳號屬於該專案的成員，則您可以點選在資料集搜尋顯示頁面上的「新增資料集」進行發布。

**步驟 2**. 建立資料集後設資料，可包含附錄 :ref:`dataset_fields` 之欄位：

.. image:: /images/add_dataset_1.png

.. note::

   上述所介紹的欄位，實務上仍建議至少填寫資料描述與授權欄位。請您需確認「專案」欄位所選擇的專案為正確，因為在後續完成資料發布的過程中，本欄的資訊將無法被修改（需後續使用編輯資料集功能）。

**步驟 3**. 當您填寫本頁之後設資料完畢後，請選取「下一步：新增資料」按鈕。或者您可選擇「取消」按鈕，放棄本頁所編輯之內容。

.. _add_resource:

**步驟 4**. 平台介面接著將顯示「新增資料」頁面。

  .. image:: /images/add_dataset_2.png

本頁面將引導您進行新增一個或多個屬於該筆資料集的「資源」。在「檔案」項目上，您可以選擇上傳一個檔案或是新增該筆檔案的連結。

* 若您所要新增的資料為線上資源或 API，請在「檔案」項目上點選「連結」鈕，並將線上資源的連結位址填入。

* 若您所要新增的資料位於本機，請在「檔案」項目上點選「上傳」連結，並選擇欲上傳的資料。

**步驟 5**. 新增關於「資源」的描述（請參閱附錄 :ref:`resource_fields` ），本平台並不強制要求您輸入這些資訊，但實務上仍建議您填寫。

**步驟 6**. 若您有其他多筆資源欲新增，請點選「儲存並新增其他項目」按鈕，來新增一筆新的資源。

**步驟 7**. 若您已完成資源的新增，點選「結束」按鈕，本平台將建立該筆資料集並顯示結果。至此步驟您已成功完成資料集的建立。

您現在應該可以於本平台的搜尋框中，透過輸入資料集的標題、或是其描述欄位內的相關文字來搜尋得到您所建立的資料集。關於搜尋資料的相關參考資訊請參考 :ref:`finding_data` 部分。

.. _adding_a_dataset_to_topic:

本平台補充功能——將資料集加入選定的主題
--------------------------------------

「主題」與「專案」主要之差別在於，「主題」機制之劃分不具有資料權屬之特性（詳細可參考 :ref:`creating_an_organization` ），亦即在本平台內一份資料集僅可屬於單一「專案」內，且該專案可以決定該資料集公開與否或專案內成員編輯權限；相較之下，「主題」僅將資料集進行分類，且一個資料集不限定僅屬於單一主題。

本平台參考 `英文維基百科 <https://en.wikipedia.org/wiki/Portal:Contents/Categories>`_ 之分類，建立下列主題：

* 一般性參考資料
* 文化與藝術
* 地理與地方
* 健康與健身
* 歷史與事件
* 人類活動
* 數學與邏輯
* 自然與物理科學
* 人群與個人
* 哲學與思想
* 宗教與信仰
* 社會與社會科學
* 技術與應用科學

您亦可以選用 `ISO19115 <https://www2.usgs.gov/science/about/thesaurus-full.php?thcode=15>`_ 後設資料標準之主題類別：

* **農業相關類 (Farming)**：與動物飼養和/或植物種植有關之主題，例如農耕、灌溉、水栽法、農園、畜牧、病蟲害和家畜。
* **生物生態類 (Biota)**：與自然環境中植物群和/或動物群有關之主題，例如野生動物、植被、生物科學、生態學、荒漠、海洋生活、溼地、棲息地。
* **土地邊界類 (Boundaries)**： 與土地權利描述有關之主題，例如行政邊界界線。
* **氣候氣象類 (Climatology Meteorology Atmosphere)**：與大氣的處理過程與現象有關之主題，例如雲、天氣、氣候、大氣條件、氣候改變、降雨量。
* **經濟活動類 (Economy)**：與經濟活動和狀態有關的主題，例如生產、勞動、稅收、貿易、工業、觀光和生態旅遊、林業、漁業、商業或補狩業、 探測和資源開發，如礦物、石油或天然氣。
* **高程資訊類 (Elevation)**：高於或低於海平面的高程資訊，例如高度、海洋探測、數值高程模型、坡度。
* **環境活動類 (Environment)**：與環境資源、保護和保存有關的主題，例如環境汙染、資源浪費、環境衝擊評估、環境監控風險、天然保育區、景觀。
* **地球科學相關類 (Geoscientific Information)**：與地球科學有關之主題，例如地球物理學的地物特徵、地質學、 礦產資源、組合科學、地球岩盤的組成起源、地震危機、火山活動、山崩、重力資訊、土壤、永久凍土、水文地質學、侵蝕。
* **健康衛生類 (Health)**：與健康、健康服務、人文生態學與環境安全有關之主題，例如疾病與身體不適、影響健康的因素、保健法、藥物濫用、身心健康、健康服務。
* **地表覆蓋資訊類 (Imagery Base Maps Earth Cover)**：與底圖有關之主題，例如地表、地形圖、影像、未分類的影像、文字註記。
* **軍事情報類 (Intelligence Military)**：與軍事基地、結構、活動有關之主題，例如兵營、訓練場、軍事運輸、情報搜集。
* **水文資訊類 (Inland Waters)**：與內陸地區的水特徵物、排水系統和其特性有關之主題，例如河流與冰河、鹽水湖、水資源利用計畫、水壩、水流、水災、水質、水道圖。
* **位置資訊類 (Location)**：與位置資訊和服務有關之主題，例如地址、控制網、控制點、郵遞區號及服務。
* **海洋資訊類 (Oceans)**：與鹽水水體的特徵物和其特性（包含內陸地區）有關之主題，例如潮汐、受潮汐影響的浪潮、海岸資訊、暗礁。
* **土地使用與規劃類 (Planning Cadastre)**：與土地未來之使用資訊有關之主題，例如土地使用圖、都市計畫圖、地籍調查、土地所有權。
* **社會文化類 (Society)**：與社會文化特性有關之主題，例如社會福利、人類學、考古學、教育、傳統信仰、禮俗習慣、人口統計資料、娛樂活動、社會影響的評價、犯罪、司法審判、人口普查情報。
* **人工設施類 (Structure)**：與人工設施有關之主題，例如建築物、博物館、教堂、工廠、住家、紀念碑、商店、塔樓。
* **交通資訊類 (Transportation)**：與運輸有關之主題，例如道路、機場/航線、運輸路線、隧道、航海圖、飛機或船之位置、航圖、鐵路。
* **公共設施類 (Utilities Communication)**： 與能源、廢棄物系統和公共通訊服務有關之主題，例如水利發電、地熱發電、太陽能與核能、水質淨化與供給、污水收集處理、電力和天然氣供給、數據交換、長途電信、無線電、通信網路。

將資料集加入相關主題群組前，您必須先完成資料集的完整發布（即完成 :ref:`adding_a_new_dataset` 內容所述步驟），接著執行下列步驟：

* 前往資料集頁面（可藉由輸入關鍵字來找到您想修改的資料集）。

* 在資料集顯示頁面切換至「主題」頁籤。

    .. image:: /images/add_topic_1.png

+ 選擇欲加入至該資料集的主題，點選「加入主題」鈕，即可加該主題於資料集內。

    .. image:: /images/add_topic_2.png

.. _UI_editing_extend:

本平台補充功能——填寫輔助功能介紹
--------------------------------

.. _UI_editing_extend_time:

* **時間資訊（資料內容時間）**

本平台所定義之時間資訊為指資料內容所描述之時間範疇，並非資料產生或完成之日期。相關後設資料項目包含：

  * *時間解析度* -- 時間解析度為表示資料內容對應時間所能精確描述之程度。可以指「相鄰兩次觀測的最小時間間隔」，或「在不確定開始與結束的明確時間時，最大的誤差範圍」。候選項目包含：年、月、日。

  * *起始、結束時間* -- 為資料集之起始、結束時間點，接受的格式為 YYYY、YYYY-MM、YYYY-MM-DD。

.. image:: /images/temporal_info.png

.. _UI_editing_extend_spatial:

* **空間資訊**

本平台所定義之空間範圍為指資料集內容所約略對應之真實世界空間範圍，設計主要考量為用於空間索引，後續可進行空間搜尋操作，其內容須符合 GeoJSON 格式標準，但對一般使用者而言直接產出 GeoJSON 格式內容並不容易，因此在介面上，本平台設計以下兩種方式：

   * *使用圖台填寫* -- 本平台提供地圖介面，讓使用者自行描繪資料集對應之空間範圍，並自動產生描繪範圍之 GeoJSON 內容。

   * *使用四至範圍填寫* -- 若使用者已具有代表資料集空間範圍之四至經緯度坐標（即東西經度、南北緯度），則可填寫於對應之空間範圍欄位內，填寫完畢後點選「使用上述四至範圍填寫空間範圍」按鈕，系統將根據四至經緯度坐標自動產生對應之 GeoJSON 內容。

您亦可於此填寫資料集之空間解析度。

.. image:: /images/spatial_info.png

* **使用快捷方式代入帳號資訊**

若使用者即為資料集之聯絡人，本平台提供一便捷的方式自動代入使用者帳號的個人資訊，點選「使用您的帳號資訊填入聯絡人與電子郵件」鈕，系統將自動填寫聯絡人及聯絡人的電子郵件欄位（帳號個人資訊請參考 :ref:`managing_profile` 內容）。

.. image:: /images/profile_input.png

.. _editing-a-dataset:

編輯資料集
----------

您可以編輯您所建立的資料集或是您所屬於的專案內的資料集。若一個資料集不屬於任一專案，則可被任何使用者帳號編修。

#. 前往欲編輯資料集其所屬頁面（可藉由輸入關鍵字來找到您想修改的資料集）。

#. 點選頁面右上方的「管理」功能鈕。

#. 顯示資料集編輯的頁面，在「編輯中繼資料」頁籤中，您可以編輯頁面中任何的欄位內容（如：標題、摘要等）、變更資料集是否為公開。關於欄位的介紹可請參考 :ref:`adding_a_new_dataset` 部分。

#. 當您完成編輯後，點選「更新」以儲存您剛才所編輯的內容。

.. image:: /images/edit_dataset.png

.. _dataset_collaborators:

資料集協作者
------------

除傳統以專案作為權限管理的方式，本站亦提供「資料集協作者」功能，可針對單一資料集進行權限控制。
您可以使用此功能修改專案成員存取資料集的權限，或賦予不屬於專案之成員存取個別資料集的權限。

欲進入協作者管理頁面，請點選資料集編輯頁面上方的「協作者」頁籤。

預設情況下，只有資料集所屬專案的管理者可以新增協作者。協作者有以下兩種身份：

**成員** 可以：

* 瀏覽設定為非公開的資料集。

**編輯** 擁有 **成員** 的所有權限，加上：

* 將資料集設定為公開或非公開。
* 編輯或刪除資料集（包括將資料集加入專案）。

新增、刪除及修改資源
--------------------

#. 前往欲編輯資料集其所屬頁面（參考上述步驟 1-2）。

#. 在「資料」頁籤中，您可以進行該資料的編輯，您可以選擇一筆資料進行編輯或刪除，若您想為該筆資料集新增一筆資源，可點選「加入新資源」功能鈕。

#. 點選一筆資源進行編輯後，您可以修改該筆資源的描述資訊、變更資源的連結或上傳新的檔案（詳細請參考上述 「新增資源」步驟 4-5）。

#. 當編輯完成後，點選「更新資源」鈕即可完成更新；若您想刪除該筆資源，則點擊「刪除」按鈕。

刪除資料集
----------

#. 前往欲編輯資料集其所屬頁面（參考上述「編輯資料集」）。

#. 點選「刪除」按鈕。

#. 頁面將顯示確認刪除資料集對話框，點選「確定」即可刪除該筆資料集內容（後設資料與資源）。

.. note::

   上述「刪除資料集」功能並非真正將資料集自本平台移除，而是將該筆資料集隱藏。因此刪除的資料集將無法透過介面被搜尋或查找得到。但若是於網址列上直接輸入該筆資料集之網址，您仍能看到該筆資料集的資訊（需具對應之權限）。若您需要「完整」自本平台移除該筆資料集，請聯繫系統管理員為您執行。

.. _creating_an_organization:

建立專案
--------

一般而言，每筆資料集都有其所屬的「專案」，而每個專案由不同的成員所組成，專案內的成員可以編輯專案內的資料集或發布新的資料集，而在本平台中，專案管理者可以設定不同權限予不同的專案成員，例如：有些成員僅允許他有瀏覽專案內資料集的權限，特定使用者則具備發布與編輯資料集的權限。每一個專案都有其所屬頁面，使用者可以在專案頁面內查看該專案的資訊並搜尋專案內的資料。因此，本平台的專案機制提供特定單位控管其內部發布政策。

建立專案流程：

#. 點選頁面上方的「專案」頁籤。

#. 點選搜尋列下方的「建立專案」功能鈕。

#. 將顯示建立專案的頁面。

#. 您必須輸入專案的名稱，您可以選擇是否建立專案描述或為專案加入一張代表圖片。

#. 點擊「建立專案」按鈕，將建立該專案並顯示該專案的首頁內容（該專案內目前應無任何資料集）。

.. image:: /images/create_project.png

您現在可以設定專案內其他成員之使用權限，請參考下段 :ref:`managing_an_organization` 內容；您也可以建立專案內的資料集，請參考上述 :ref:`adding_a_new_dataset` 內容。

.. note::

   您可以參考 :site_url:`既有專案 <organization>` 填寫您的專案資訊。另外，根據管理員的設定，並非每個帳號都有建立新專案的權限，當您想建立新專案但不具權限時，您可以聯繫系統管理員。

.. _managing_an_organization:

管理專案
--------

當您建立一個新專案時，本平台會自動將您設定為該專案之「管理者」。在專案首頁內您可以看到搜尋框上方之「管理」功能鍵，當您點選該功能鍵即可進入專案管理介面。專案管理介面包含下列兩頁籤功能：

* *資訊* -- 本頁籤內您可以編輯專案的資訊（名稱、描述、專案圖片）。

* *成員* -- 本頁籤內您可以新增、移除專案成員或變更專案成員之權限（您需要事先知道欲加入專案成員者於本平台之使用者帳號）。

.. image:: /images/manage_project.png

本平台包含下列三種專案權限：

* *成員* -- 可以瀏覽專案內之非公開資料集。

* *編輯者* -- 可以編輯或新增專案內資料集。

* *管理者* -- 可以新增、刪除專案成員，或變更成員權限。

邀請專案成員（共同協作者）
--------------------------

若您需要與他人共同協作編修資料集，可由您的專案頁面右上的「管理」按鈕進入專案管理頁面，並點選「成員」頁籤進入成員管理頁面，如下圖所示：

.. image:: /images/invite_user.png

您可於「已存在的使用者」欄位，以帳號搜尋並選取欲加入專案之本平台使用者，或輸入其電子郵件位址以邀請其加入本平台。您並可設定該使用者於專案之角色，按下右下「新增成員」按鈕後，系統即會將該使用者加入您的專案。

.. _finding_data:

查找資料
========

全站搜尋
--------

您可以在搜尋框內輸入任意的關鍵字組合來找尋資料，（如：健康、交通），本平台將回傳符合搜尋關鍵字條件的資料集於搜尋結果頁面，您可以再進一步：

* 瀏覽更多頁的搜尋結果。

* 以不同的關鍵字再進行搜尋。

* 以特定的「標籤」、「格式」等位於頁面左側欄位的過濾條件來進一步約制搜尋的結果。

當您所回傳的搜尋結果數目很龐大時，過濾條件的功能將會非常實用，您可以結合多重的過濾條件，並動態地新增與移除過濾條件，當您重新輸入關鍵字時，這些過濾條件也仍會被保留。

.. image:: /images/search_the_site.png

本平台補充功能——時間搜尋功能介紹
--------------------------------

本平台已擴充時間搜尋功能，您可以設定感興趣資料之時間區間，當您進到資料集搜尋頁面時，時間搜尋條件設定位於頁面左側欄位處。您可以拖拉方式設定搜尋時間軸。

.. image:: /images/temporal_search.png
  
本平台補充功能——空間搜尋功能介紹
--------------------------------

本平台擴充空間搜尋功能，您可以設定感興趣資料之空間範圍，當您進到資料集搜尋頁面時，空間搜尋條件設定位於頁面左側欄位處。

本功能為針對資料集後設資料中之空間資訊欄位（請參閱 :ref:`空間資訊填寫輔助功能 <UI_editing_extend_spatial>` ），若後設資料中該欄位無記錄，則可能無法由此功能尋得該資料集。

其操作步驟如下：

#. 點選地圖視窗右上方之畫筆圖示。

   .. image:: /images/spatial_search_1.png
      
#. 點擊後，地圖將展開於搜尋頁面正上方，此時您可於地圖上畫設感興趣之空間範圍。

   .. image:: /images/spatial_search_2.jpg
      
#. 當您劃設範圍完成後，地圖將縮回搜尋頁面左側欄位，系統並自動進行過濾符合條件之資料集。

#. 若您想重新設定空間查詢條件，則再重新執行上述步驟 1-2。

搜尋專案內的資料集
------------------

若您想找尋特定專案內的資料集，您可以在該專案的頁面內進行搜尋：

#. 點選頁面上方「專案」頁籤。

#. 點選您所欲搜尋的專案項目，頁面將顯示該專案的首頁。

#. 輸入您所欲搜尋的關鍵字於專案頁面上方的搜尋框。

系統將回傳於該專案內符合您所設定搜尋條件的資料集。

如果您對於特定專案所發布的資料內容感興趣，您可以在該專案的首頁左方欄處，點選「跟隨」功能鍵，您將可以收到該專案資料集變動的通知。詳細內容請參考 :ref:`managing_your_news_feed` （您必須具有使用者帳號才能執行此功能）。

探索資料集
----------

當您找到您所感興趣的資料集後，您可以點選該筆資料集進一步了解內容，您可以看到：

* 該筆資料集的名稱、描述以及其他相關後設資料資訊。

* 該筆資料集所包含的資源與其對應連結。

.. image:: /images/exploring_datasets.png

每筆資源的連結將會導向每個資源的描述頁面，或者也可以直接下載該筆資源。CKAN 另一個強大的功能為資源的「預覽」功能，許多格式的資源可以直接在資源頁面上預覽，如 CSV、Excel 等類型的資源可以直接顯示表格在網頁上；透過額外的設定，也能直接在頁面上瀏覽 PDF、影像與網頁。

資料集顯示頁面另外包含兩個頁籤功能：

* *動態牆* -- 您可以瀏覽到該筆資料集歷史的修改記錄。

* *主題* -- 您可以瀏覽該筆資料集所屬的主題。

若您對特定資料集感興趣，您可以點選資料集頁面左欄處的「跟隨」功能鈕，訂閱該筆資料集。詳細內容請參考 :ref:`managing_your_news_feed` （您必須具有使用者帳號才能執行此功能）。

本平台補充功能——引用資料集
--------------------------

您可使用資料集頁面左下角「引用為」工具，獲得該資料集之引用格式，如下圖：

.. image:: /images/citation.png

本平台提供主流引用格式：

* American Psychological Association 6th edition (APA)
* Modern Language Association 8th edition (MLA)
* Chicago Manual of Style 17th edition (note)
* Chicago Manual of Style 17th edition (author-date)
* IEEE
* Council of Science Editors, Citation-Sequence (numeric) (CSE C-S)
* American Medical Association (AMA)
* American Chemical Society (ACS)
* American Institute of Physics (AIP)
* American Society of Civil Engineers (ASCE)

您亦可使用下拉選單上之搜尋列，找尋您需要的引用格式。

完整引用格式列表，可至 `CSL Style Repository <https://github.com/citation-style-language/styles/tree/f5a731144d4b0a838e66ce60cd62a92f7a9e66df>`_ ，按下 t 鍵後進行搜尋。

.. note::

   若該資料集獲配 :ref:`ark-identifier` ，引用文字的網址將為 ARK URL；若否，則為資料集之網址。

.. _data_preview:

本平台補充功能——資料預覽功能介紹
--------------------------------

本平台的「資源」頁面的一項強大功能為「資料預覽」介面，您可以透過介面預覽資料的內容，來評估資料是否符合您的需求，其操作步驟為：

#. 前往資料集頁面（可藉由輸入關鍵字來找到您想修改的資料集）。

#. 在「資料與資源」清單內，於欲預覽資源的項目上，點選「探索」鈕內之「預覽」功能鈕。

   .. image:: /images/data_preview_1.png
    
#. 在資源顯示頁面您即可瀏覽資料集內容。

   .. image:: /images/data_preview_2.png
    
本平台預設會依據資源後設資料的「格式」項目設定資料預覽（參閱 :ref:`adding_a_new_dataset` 步驟 5 內容），下列為本平台支援之預覽格式：

* 文字類：txt, html, xml, json, geojson。

* 影像類：png, jpg, jpeg, gif。

* 影片類：MP4, WebM, Ogg。

* 音訊類：MP3, WAV, Ogg。

* 表格類：csv, xls(x)。

* 空間資料：WMTS, WMS, Shapefile（Shapefile 請標記為「shp」，否則將無法預覽）。

* 其他：PDF, 一般網頁連結。

當您所設定之資源格式類型符合上述任一項目時，本平台即會自動呈現相應之預覽介面。

.. image:: /images/data_preview_3.png

此外，單一資源可以設定多種預覽呈現方式，例如原始資料格式若為 CSV 格式，則本平台預設以表格類的方式提供資料預覽介面，但實際資料內容若有包含空間資訊，資料提供者可再另行建立空間預覽的介面。

欲新增預覽介面於特定資源頁面之步驟如下：

#. 前往欲新增預覽介面之資源頁面。

#. 點選「管理」功能鈕（您需具有編輯該資料集的權限才會顯示此功能鈕）。

   .. image:: /images/new_preview_1.png
    
#. 在資源編輯頁面內切換至「檢視」頁籤，並於「新增檢視」下拉選單內，選擇適合該資源的預覽類型後進行設定：

   * Data Explorer：可同時提供表格、統計圖、地圖介面三種預覽方式，可於設定內選擇過濾的條件（如某欄位的值須大於門檻值才會顯示）。

   * Grid：提供表格預覽介面，可於設定內選擇過濾的條件。

   * Map：提供地圖預覽介面，您須於設定內指定代表經緯度的欄位，亦可設定過濾條件。

   * 圖片：您可新增一張外部圖片（須為連結）來做為資源預覽圖。

   * 網站：您可新增一個網站連結來做為預覽介面。

   .. image:: /images/new_preview_2.png

#. 完成預覽模式設定後按「新增」即完成新增預覽（您也可以使用「預覽」按鈕來事先查看完成發布後的情況）。

.. _data_api:

資料 API
========

對於結構化之資源內容，如 CSV、Excel 檔案等，本平台會於其上傳後自動將結構化資源匯入後端資料庫，並產生每一個資源對應的資料存取介面（API），開發者即可透過使用此資料 API 來開發應用服務或系統。取得結構化資源 API 的方式為：

#. 前往該資源頁面。

#. 點選頁面「資料 API」功能鈕，頁面將顯示該筆資源的 API 與操作方式。

   .. image:: /images/data_api_1.png

   .. image:: /images/data_api_2.png
  
#. 部分 API 功能會需要使用者帳號的 API Key 作為認證，取得方式為至個人資訊頁面（點選任一頁面最上方之個人帳號），API Key 將顯示於頁面左欄下方處。您亦可使用位於頁面上方的 API Tokens 功能取得 API Key。

    .. image:: /images/data_api_3.png

.. _rdf_serializations:

RDF Serializations (串列化輸出)
===============================

本平台使用 ckanext-dcat 提供之 `RDF 串聯器 (serializer) <https://github.com/ckan/ckanext-dcat/tree/v1.1.0#rdf-dcat-serializer>`_ 輸出 RDF graph。

關於本平台後設資料與 RDF graph 輸出語彙間之對照，請參閱 :doc:`appendix/metadata-mapping/dcat/index`。

.. note::

   此功能正在測試中，如有任何問題或建議，請 聯絡我們_。

.. note::

   支援的輸出格式如下表所示：

   ========= ========= ===================
   格式      副檔名    網際網路媒體類型
   ========= ========= ===================
   RDF/XML   xml       application/rdf+xml
   Turtle    ttl       text/turtle
   Notation3 n3        text/n3
   JSON-LD   jsonld    application/ld+json
   ========= ========= ===================

.. hint::

   以下說明中出現之 ``{}``：

   * ``dataset-id`` 請填寫資料集 **網址 (名稱)**
   * ``format`` 請填寫上方表格之 **副檔名**
   * ``media_type`` 請填寫上方表格之 **網際網路媒體類型**

方法一：RDF Endpoints
----------------------

.. parsed-literal::

   全站資料集：

   :site_url:`catalog.{format}`

   單一資料集：

   :site_url:`dataset/{dataset-id}.{format}`

您亦可至資料集頁面左下角「其他存取方式」獲得該資料集之 RDF 串列化結果，如下圖：

.. image:: /images/rdf_serializations.png

方法二：內容協商 (Content Negotiation)
--------------------------------------

請於終端機執行以下指令：

.. parsed-literal::

   curl :site_url:`dataset/{dataset-id}` -H Accept:{media_type}

範例
----

以此 :site_url:`範例資料集 <dataset/place-names-in-west-central-district-of-tainan>`，取得 RDF/XML 格式為例：

方法一：

.. parsed-literal::

   :site_url:`dataset/place-names-in-west-central-district-of-tainan.xml`

方法二：

於終端機執行以下指令：

.. parsed-literal::

   curl :site_url:`dataset/place-names-in-west-central-district-of-tainan` -H Accept:application/rdf+xml

.. _ark-identifier:

ARK 持續識別碼
==============

`資源典藏碼 <https://arks.org/about/>`_ (Archival Resource Key, ARK) 是一種多用途、可以用來指稱各類資訊物件的通用識別碼。本平台透過 `ckanext-ark <https://github.com/depositar/ckanext-ark>`_ 套件，賦予符合條件的資料集以 ARK 為編碼規格的持續識別碼 (persistent identifier, PID)，提供資料集長期不變的網址，功能類同於數位物件識別碼 (Digital Object Identifier, DOI)。

.. note::

   此功能正在測試中，如有任何問題或建議，請 聯絡我們_。

本服務發行的 ARK 持續識別碼均以 ``ark:`` 開頭（例如： ``ark:37281/k5c8w2q9c`` ），依序以下列編碼規則產生：

* ``37281`` ：註冊於 `N2T.net <https://n2t.net/ark:37281/>`__ 之 `NAAN <https://arks.org/about/ark-naans-and-systems/>`_ (Name Assigning Authority Number)，用以識別 ARK 的發行組織
* ``k5`` ：固定且專用於本平台資料集的子命名空間（ARK 稱之為 `shoulder <https://www.ietf.org/archive/id/draft-kunze-ark-34.html#name-optional-shoulders>`_ ）
* 唯一識別碼：ARK 稱之為 blade，為使用 ``redededk`` 規則（ARK 稱之為 `template <https://metacpan.org/dist/Noid/view/noid#TEMPLATES>`_ ）編碼之 7 位英數字：

  * ``r`` 代表該 7 位英數字識別碼為準隨機生成 (quasi-randomly generated)
  * ``e`` 代表該位數為右列擴充字元 (extended digit) 之一： ``{0123456789bcdfghjkmnpqrstvwxz}``
  * ``d`` 代表該位數為右列純數字 (pure digit) 之一： ``{0123456789}``
  * ``k`` 代表最後一位的校驗字元 (check character)

關於 ARK 的技術規格，請參考此 `IETF 網際網路草案 <https://datatracker.ietf.org/doc/draft-kunze-ark/>`_ 。

ARK 識別碼發放條件
------------------

為確保 ARK 識別碼得以廣泛流通，與滿足後設資料需求，資料集需設定為公開，且至少填寫以下欄位：

* 標題
* 起始時間（與「結束時間」至少填寫其中之一）
* 結束時間（與「起始時間」至少填寫其中之一）
* 產製者

.. note::

   * 請參考 :ref:`後設資料項目 <dataset_fields>` 。
   * 關於資料集的公開與非公開，請參考 :ref:`editing-a-dataset` 。將不公開資料集設為公開，亦可獲得 ARK 識別碼。
   * 若您於 ARK 識別碼配發後，移除上述欄位，ARK 仍為有效，且會保留包含上述欄位的後設資料 (ERC)。

透過 ARK 識別碼連結至資料集
---------------------------

您可以在資料集頁面左下角的「ARK 識別碼」查詢以 ``ark:`` 開頭之 ARK 識別碼與網址，如下圖：

.. image:: /images/ark_1.png
  :width: 300

此 ARK 網址將自動導向資料集頁面。

本平台所使用的 ARK 識別碼名稱對應服務 (Name Mapping Authority, NMA) 為 https://pid.depositar.io/。您亦可使用 `N2T.net <https://n2t.net/>`__ 所提供的對應服務，僅需將網址的 https://pid.depositar.io/ 代換為 https://n2t.net/ 即可。

.. note::

   展示用網站 (https://demo.depositar.io/) 的 NMA 為 https://demo.depositar.io/，且不支援 N2T.net 對應服務，亦不保證 ARK 識別碼之持續性。

ARK 識別碼後設資料 (ERC)
------------------------

您可於 ARK 識別碼網址後方加上 ``?info`` ，即可獲得該描述該識別碼的簡要後設資料。

.. note::

   此後設資料稱為 `ERC (Electronic Resource Citation) <https://n2t.net/ark:/13030/c7sn0141m>`_ 。本平台使用 ERC 記載資料集的摘要資訊。

ERC 資訊以 JSON 格式呈現，在 ``erc`` 屬性內包含以下資料：

====== ================= =============================================
欄位   內容              取自 :ref:`後設資料項目 <dataset_fields>`
====== ================= =============================================
what   標題              標題
when   時間資訊          起始時間與結束時間，以 YYYYMMDD-YYYYMMDD 呈現
where  此 ARK 識別碼網址 無（由系統自動產生）
who    產製者            產製者
====== ================= =============================================

已失效 ARK 識別碼
-----------------

在資料集獲配 ARK 識別碼後，若您執行以下動作，將令 ARK 識別碼失效：

* 將資料集設為不公開
* 將資料集刪除
* 將資料集永久刪除（僅系統管理員具有此權限）

在上述情況下，連結至 ARK 識別碼網址，系統將顯示以下已失效 ARK 頁面：

.. image:: /images/ark_2.png
  :width: 400

針對以上前兩種情形，已失效的 ARK 識別碼仍可如下部份運作：

* 雖已將資料集設為不公開，但登入具有該資料集瀏覽權限之帳號時
* 雖已將資料集刪除，但登入該資料集產製者之帳號時

.. note::

   * 若您將資料集重新公開，或復原已刪除資料集，對應之 ARK 識別碼即會恢復有效狀態。
   * 已失效 ARK 識別碼仍會保留其後設資料 (ERC)。

個人化設定
==========

本平台提供部分個人化設定功能，您可以設定搜尋資料或發布資料時的喜好（以下功能需先登入帳號後方能執行）。

.. _managing_your_news_feed:

新聞消息來源
------------

本平台頁面最上方為固定的使用者帳號功能列，請點選儀表版圖示（位於您的帳號名稱右方），儀錶板頁面將顯示您所訂閱的資料集變動消息、您所加入或訂閱專案的資料集變動情況、或您於本平台上操作資料集的歷史記錄。儀錶板上的數字顯示為自您上回查看儀表板後所新增的新聞消息。此外，除了專案與資料集，您也可以訂閱特定的使用者帳號。

.. image:: /images/manage_news_feed.png

若您想停止追蹤特定資料集（或專案），您可以至該筆資料集的頁面點選「取消追蹤」。

.. _managing_profile:

帳號資訊
--------

您可以於帳號資訊頁面變更您在本平台的個人資訊設定。您可於頁面最上方的使用者帳號功能列，點選齒輪圖示進入帳號資訊頁面。

.. image:: /images/manage_user_profile.png

您可以於使用者設定頁面修改下列資訊：

* 帳號

* 使用者名稱

* 電子郵件（本資訊為非公開性）

* 您的個人簡介

* 密碼

.. note::

   如果您修改您的使用者帳號，本平台將會將您目前的帳號登出，您必須以新的帳號進行登入。

.. _limitation:

系統限制
========

目前本平台之系統限制包含以下：

* 檔案上傳大小限制：約容許 1GB 內之檔案上傳。

* 預覽檔案限制：一般檔案可預覽的大小約 20MB，PDF 檔案可允許較大檔案容量預覽（數十 MB）。

* 檔案名稱長度限制：為 3 至 100 字元（包含附檔名，中文以字為單位，英文以字母為單位）。

* XLS/XLSX/CSV 檔案特殊限制：欄位名稱長度 63 英數字，相當 21 中文字以內。不支援合併儲存格與兩個以上工作表。
